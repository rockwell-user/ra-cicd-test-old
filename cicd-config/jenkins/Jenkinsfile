pipeline {
    agent { 
        node {
            label 'docker-agent-alpine'
            }
      }
    triggers {
        pollSCM '* * * * *'
    }
    parameters {
        string(name: 'NAME', description: 'Rockwell Automation')
        text(name: 'DESC', description: 'This is an example CI/CD pipeline for Studio 5000 Logix Designer application development.')
    }
    stages {
        stage('Test') {
            steps {
                echo "Testing.."
                // "${env.WORKSPACE}/JenkinsScripts/myScript.groovy"
                script {
                    def exitCode = bat(returnStatus: true, script: 'cicd-config\stage-test\stage-test-configuration\LogixSDKDemoApp\bin\Debug\net6.0\TestStage_CICDExample DEVELOPMENT-files\CICD_test.ACD EmulateEthernet\127.0.0.1')
                    if (exitCode == 0) {
                        echo 'Executable ran successfully'
                    } else {
                        error 'Executable failed to run'
                    }
                }
            }
        }
        stage('Publish') {
            steps {
                echo "Publishing.."
            }
        }

        stage('Deliver') {
            steps {
                echo 'Delivering....'
            }
        }
    }
}
